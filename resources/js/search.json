[[{"l":"Cryptography Notes","p":["A collection of notes on cryptography related subjects."]}],[{"l":"Introduction","p":["Information and images are taken from Crypto Corner. Additional sources are explicitly mentioned."]},{"l":"Steganography","p":["Steganography is the hiding of a message by a physical means. An example of steganography would be hiding a message in an image file's bytes."]},{"l":"Cryptography","p":["Cryptography is split into two ways of changing the message systematically to confuse anyone who intercepts it: these are codes and ciphers. Many people believe, and use, the word code to mean the same thing as cipher, but technically they are different.","Codes are ways of changing messages by replacing each word with another word that has a different meaning.","Ciphers convert messages by a rule, known only to the sender and recipient, which changes each individual letter (or sometimes groups of letters)"]},{"l":"Conventions","p":["plaintext= the message that is being encrypted","ciphertext= the encrypted message","alphabet= letters and symbols which will be transformed by the cipher"]}],[{"l":"Monoalphabetic Substitution Ciphers","p":["Information and images are taken from Crypto Corner. Additional sources are explicitly mentioned.","A monoalphabetic substitution is a cipher in which each occurrence of a plaintext symbol is replaced by a corresponding ciphertext symbol to generate ciphertext. ( Cornell University, Math 135, 2006)","Applying a monoalphabetic substitution cipher multiple times is equivalent to applying it once!","E is the encryption function. D is the decryption function."]},{"l":"Caesar cipher"},{"l":"Encryption","p":["Considering the 26-letter English alphabet and an integer key, 0 <= K < 26, encryption is done by shifting the alphabet to the left by K positions. For example, with K = 3, \"A\" would be encrypted to \"D\".","Mathematically, if i is the i-th letter in the zero-indexed English alphabet, then E(i, K) = i + K \\pmod{26}"]},{"l":"Decryption","p":["Decryption is the reverse process, that is shifting the alphabet to the right by K positions.","D(i, K) = i - K \\pmod{26}"]},{"l":"Observations","p":["Modulo is needed because we are stuck in the 26-letter alphabet. Thus, a key of 1 is the same as a key of 27 because 1 \\pmod{26} = 27 \\pmod{26}.","Regarding the fact that applying a monoalphabetic substitution cipher multiple times is equivalent to applying it once:","E(E(i, K_{1}), K_{2}) = (i + K_{1} \\pmod{26}) + K_{2} \\pmod{26} = i + K_{1} + K_{2} \\pmod {26} = i + K_{3} \\pmod{26}"]},{"l":"Affine cipher","p":["The affine cipher is a generalization of the caesar cipher. Now, the alphabet is of dimension m, and there are two keys: a and b."]},{"i":"encryption-1","l":"Encryption","p":["E(x,a,b) = ax + b \\pmod{m}"]},{"i":"decryption-1","l":"Decryption","p":["D(x,a,b) = a^{-1}(x - b) \\pmod{m}","a and m have to be coprime, otherwise we can't compute a^{-1}.","Explanation (for details, see notes on modular arithmetics):"]},{"i":"observations-1","l":"Observations","p":["The Caesar cipher is the affine cipher with a = 1(and m = 26, if we only use letters from the English alphabet).","If, for example, m=26, the number of possible values for a is \\varphi(26)=12(see notes on Euler's totient function)). b can be any value that satisfies 0 <= b < 26. So the possible number of valid affine cipher keys if m=26 is 12 \\cdot 26 = 312."]},{"l":"Frequency Analysis","p":["The method behind frequency analysis is based on the letter frequency of the English alphabet. For example, the most common letter in the English alphabet is \"E\". Thus, if a message encrypted with a monoalphabetic substitution cipher is long enough, we can pretty safely assume that its most common letter is the ciphertext for \"E\". We can repeat this process for every letter in the frequency distribution (see image below).","Letter frequency in the English alphabet","Every single type of monalphabetic substitution is easily breakable using frequency analysis."]}],[{"l":"Hill Cipher","p":["Information and images are taken from Crypto Corner. Additional sources are explicitly mentioned.","The Hill cipher is a polygraphic (that acts on groups of letters, instead of one letter) substitution cipher that is based on matrix operations. This page is focused on 2\\times2(digraphic) and 3\\times3(trigraphic) variants of the Hill cipher, but it can be extended to more dimensions. The cipher is more easily explained with an example."]},{"l":"Encryption","p":["In this scenario, we will use with the English alphabet again. Each letter is represented by its index in the alphabet, starting from 0. We are working with modular operations again \\pmod{26}. For example, in a 2\\times2 Hill cipher scenario, let's consider the following 2\\times2 key:","K = \\begin{pmatrix} H && I \\\\ L && L \\end{pmatrix} = \\begin{pmatrix} 7 && 8 \\\\ 11 && 11 \\end{pmatrix}","The message \"short example\" will be encrypted. Spaces will be taken out and letters will be written into digraphs represented by 2-dimensional vectors, as such:","M = \\begin{pmatrix} S \\\\ H \\end{pmatrix} \\begin{pmatrix} O \\\\ R \\end{pmatrix} \\begin{pmatrix} T \\\\ E \\end{pmatrix} \\begin{pmatrix} X \\\\ A \\end{pmatrix} \\begin{pmatrix} M \\\\ P \\end{pmatrix} \\begin{pmatrix} L \\\\ E \\end{pmatrix} = \\begin{pmatrix} 18 \\\\ 7 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 17 \\end{pmatrix} \\begin{pmatrix} 19 \\\\ 4 \\end{pmatrix} \\begin{pmatrix} 23 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 12 \\\\ 15 \\end{pmatrix} \\begin{pmatrix} 11 \\\\ 4 \\end{pmatrix}","To encrypt each digraph, we perform a matrix multiplication. 2-dimensional matrix multiplication is performed in the following way:","\\begin{pmatrix} a && b \\\\ c && d \\end{pmatrix} \\begin{pmatrix} x && y \\end{pmatrix} = \\begin{pmatrix} ax + by \\\\ cx + dy\\end{pmatrix}","In general, when we multiply two matrices, there are two things to keep in mind:","the first matrix's column number must be equal to the second matrix's row number","if the first matrix is of dimension (M, N) and the second matrix is of dimension (N, P), their product is of dimension (M, P)","The first encrypted digraph is computed as follows:","\\begin{pmatrix} 7 && 8 \\\\ 11 && 11 \\end{pmatrix} \\begin{pmatrix} 18 \\\\ 7 \\end{pmatrix} = \\begin{pmatrix} 182 \\\\ 275 \\end{pmatrix} \\pmod{26} = \\begin{pmatrix} 0 \\\\ 15 \\end{pmatrix} = \\begin{pmatrix} A \\\\ P \\end{pmatrix}","Remember we are in the the English alphabet, so we must apply modulus. Each digraph is encrypted like the above operation. After encryption, we can switch back from letter indexes to letters."]},{"l":"Decryption","p":["For decrpytion, we must compute the inverse of the key matrix.","K^{-1} = d^{-1} \\times adj(K), where d^{-1} is the multiplicative modular inverse of K's determinant, and adj(K) is K's adjugate matrix.","d = \\begin{vmatrix} a && b \\\\ c && d \\end{vmatrix} = ad - bc","To be invertible, a matrix must have a non-zero determinant and, since we are working in the ring of integers modulo 26, the determinant must be coprime with 26.","In general, the determinant must be coprime with the alphabet's length.","adj\\begin{pmatrix} a && b \\\\ c && d \\end{pmatrix} = \\begin{pmatrix} d && -b \\\\ -c && a \\end{pmatrix}","After computing K^{-1}, we multiply it with each encrypted digraph to get back to the plaintext. For the example above:","d(K) = \\begin{vmatrix} 7 && 8 \\\\ 11 && 11 \\end{vmatrix} = 7 \\cdot 11 - 8 \\cdot 11 = -11 \\pmod {26} = -11 + 26 \\pmod{26} = 15 \\pmod {26}","d^{-1} = 15^{-1} \\pmod {26} = 7 \\pmod {26}, which is a non-zero number coprime with 26.","adj(K) = \\begin{pmatrix} 11 && -8 \\\\ -11 && 7 \\end{pmatrix} \\pmod{26} = \\begin{pmatrix} 11 && 18 \\\\ 15 && 17 \\end{pmatrix} \\pmod{26}","K^{-1} = 7\\begin{pmatrix} 11 && 18 \\\\ 15 && 17 \\end{pmatrix} = \\begin{pmatrix} 77 && 126 \\\\ 165 && 49 \\end{pmatrix} \\pmod{26} = \\begin{pmatrix} 25 && 22 \\\\ 1 && 23 \\end{pmatrix} \\pmod{26}","Let's try decrypting the first encrypted digraph, \\begin{pmatrix} A \\\\ P \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 15 \\end{pmatrix}","K^{-1}\\begin{pmatrix} 0 \\\\ 15 \\end{pmatrix} = \\begin{pmatrix} 25 && 22 \\\\ 1 && 23 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 15 \\end{pmatrix} = \\begin{pmatrix} 25 \\cdot 0 + 22 \\cdot 15 \\\\ 1 \\cdot 0 + 23 \\cdot 15 \\end{pmatrix} = \\begin{pmatrix} 330 \\\\ 345 \\end{pmatrix} \\pmod{26} = \\begin{pmatrix} 18 \\\\ 7 \\end{pmatrix} \\pmod{26} = \\begin{pmatrix} S \\\\ H \\end{pmatrix}"]}],[{"l":"VigenÃ¨re Cipher","p":["Information and images are taken from Crypto Corner. Additional sources are explicitly mentioned."]}],[{"l":"Introduction","p":["Information and images are taken from Understanding Cryptography. Additional sources are explicitly mentioned."]}],[{"i":"#","p":["Operations with modulus"]},{"l":"Modular Arithmetics"},{"l":"Basic operations","p":["If a + b = c then a \\pmod{m} + b \\pmod{m} \\equiv c \\pmod{m}","If a \\cdot b = c then a \\pmod{m} \\cdot b \\pmod{m} \\equiv c \\pmod{m}","For modulus of negative numbers with respect to m, we must add m to the negative number until we get a number which is between 0 and m. For example, -8 \\pmod{5} = -8 + 5 \\pmod{5} = -3 \\pmod{5} = -3 + 5 \\pmod{5} = 2 \\pmod{5}."]},{"l":"Modular multiplicative inverse","p":["A modular multiplicative inverse of a with respect to modulus m, denoted a^{-1} exists if aa^{-1} \\equiv 1 \\pmod {m}.","a^{-1} exists if and only if gcd(a, m) = 1, that is, a and m are relatively prime or coprime.","Thus, if m is prime, for each 0 < a < m, there exists a modular multiplicative inverse a^{-1}."]},{"i":"eulers-totient-function","l":"Euler's totient function","p":["Two numbers are coprime if they don't share any divisors other than 1.","Used to find number of numbers coprime to a given number smaller than that number. In short, the number of numbers comprime to n and smaller than n is:","\\varphi(n)= n \\cdot (1-\\frac{1}{p_{1}}) \\cdot (1-\\frac{1}{p_{2}}) \\cdot ... \\cdot (1-\\frac{1}{p_{k}})","where p_1, p_2, ..., p_k are the distinct prime factors of n(that is, n = p_{1}^{e_1} \\cdot p_{1}^{e_1} \\cdot ... \\cdot p_{k}^{e_k}).","For example, \\varphi(20) = 20\\cdot(1-1/2)\\cdot(1-1/5) = 20\\cdot(1/2)\\cdot(4/5) = 8 because 20 = 2^2\\cdot 5. The numbers coprime to 20 and smaller than 20 are 3, 5, 7, 9, 11, 13, 17, 19.","\\varphi(26) = 26\\cdot(1-1/2)\\cdot(1-1/13) = 26\\cdot(1/2)\\cdot(12/13)=12."]}]]